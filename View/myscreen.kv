#:import Factory kivy.factory.Factory
#:import Window kivy.core.window

<MyField@MDTextField>
    size_hint_x: None
    width: '200'
    text_color: "000000"
    required: True
    helper_text: "This field is required"
    helper_text_mode: "on_error"
    multiline: False
    background_color: (1, 1, 1)
    background_normal:''
    #input_filter: "int"
    #pos_hint: {"center_y": .5}
<AddPopup@Popup>
    title: 'Регистрация'
    separator_color: (1, 0, 0, 1)

    BoxLayout:
        # background color
        canvas.before:
            Color:
                rgb: (1,1,1)
            Rectangle:
                pos: self.pos
                size: self.size



        orientation: "vertical"
        adaptive_size: True
        #spacing: "12dp"
        #padding: "12dp"
        #radius: [10, ]
        #pos_hint: {"center_x": .5, "center_y": .5}

        Label:
            text: "[color=FFCCFF]Введите ваши данные[/color]"
            markup: True
            #font_size: "H6"
            pos_hint: {"center_x": .5}
            #adaptive_size: True
#            background_color: (1,1,1)
#            canvas.before:
#                Color:
#                    rgb: self.background_color
#                Rectangle:
#                    size: self.size
#                    pos: self.pos


        # имя пациента
        MyField
            id: pet_name_input
            hint_text: 'pet name'
            on_text: root.set_pet_name(self.text)

        # дата рождения
        MyField:
            id: birth_date_input
            hint_text: 'YYYY-MM-DD'
            max_text_length: 10
            on_text: root.set_birth_date(self.text)

        Button:
            size_hint: None, None
            size: "200sp", "40sp"
            on_press: root.choose_birth_date()

        # дата последнего приёма
        MyField:
            id: last_appointment_date_input
            hint_text: 'YYYY-MM-DD'
            max_text_length: 10
            on_text: root.set_last_appointment_date(self.text)

        Button:
            size_hint: None, None
            size: "200sp", "40sp"
            on_press: root.choose_last_appointment_date()
        # имя врача
        MyField:
            id: vet_name_input
            on_text: root.set_vet_name(self.text)
            multiline: False

        # название болезни
        MyField:
            id: disease_input
            on_text: root.set_disease(self.text)
            multiline: False

        Button:
            text: 'add info'
            #disabled: True if root.everything() else False
            on_press: root.record_patient_info()
            #on_release: root.dialogs()
            #on_press: root.info()

        Button:
            text: 'вернуться в главное меню'
            #disabled: True if root.everything() else False
            on_press: root.dismiss()
            #on_press: root.info()


<SearchPopup@Popup>
    title: 'Поиск'
    separator_color: (1, 0, 0, 1)

    BoxLayout:
        # background color
        canvas.before:
            Color:
                rgb: (1,1,1)
            Rectangle:
                pos: self.pos
                size: self.size



        orientation: "vertical"
        adaptive_size: True

        MyField:
            id: pet_name
            hint_text: 'имя'
            on_text: root.set_search_pet_name(self.text)
            multiline: False

        MyField:
            id: vet_name
            hint_text: 'birth date'
            on_text: root.set_search_birth_date(self.text)
            multiline: False

        MyField:
            id: pet_name
            hint_text: 'имя врача'
            on_text: root.set_vet_name(self.text)
            multiline: False

        MyField:
            id: vet_name
            hint_text: 'дата последнего приема'
            on_text: root.set_last_appointment_date(self.text)
            multiline: False

        MyField:
            id: vet_name
            hint_text: 'фраза из диагноза'
            on_text: root.set_disease_phrase(self.text)
            multiline: False


        Button:
            text: 'поиск'
            #disabled: True if root.everything() else False
            #on_press: root.search_name_birth()
            #on_press: root.serach_last_appointment_date_vet_name()
            on_press: root.search_disease_phrase()

        Button:
            text: 'вернуться в главное меню'
            #disabled: True if root.everything() else False
            on_press: root.dismiss()


<DeletePopup@Popup>
    title: 'Удаление'
    separator_color: (1, 0, 0, 1)

    BoxLayout:
        # background color
        canvas.before:
            Color:
                rgb: (1,1,1)
            Rectangle:
                pos: self.pos
                size: self.size


        orientation: "vertical"
        adaptive_size: True

        MyField:
            id: p
            hint_text: 'pet name'
            max_text_length: 10
            on_text: root.set_pet_name(self.text)

        MyField:
            id: p
            hint_text: 'date birth'
            max_text_length: 10
            on_text: root.set_birth_date(self.text)
            #on_text: root.set_last_appointment_date(self.text)

        MyField:
            id: pet_name
            hint_text: 'имя врача'
            on_text: root.set_vet_name(self.text)
            multiline: False

        MyField:
            id: vet_name
            hint_text: 'дата последнего приема'
            on_text: root.set_last_appointment_date(self.text)
            multiline: False

        MyField:
            id: vet_name
            hint_text: 'фраза из диагноза'
            on_text: root.set_disease_phrase(self.text)
            multiline: False

        Button:
            text: 'вернуться в главное меню'
            #disabled: True if root.everything() else False
            #on_press: root.delete_pet_name_birth_date()
            #on_press: root.delete_vet_name_last_appointment_date()
            on_press: root.delete_disease_phrase()

        Button:
            text: 'вернуться в главное меню'
            #disabled: True if root.everything() else False
            on_press: root.dismiss()

<MyLabel@Label>
    pos_hint: {"center_y": .5}

<BackgroundColor@Label>
    background_color: 'FFCCFF'



<MainScreen>

    BoxLayout:
        orientation: "vertical"
        adaptive_size: True
        #spacing: "12dp"
        #padding: "12dp"
        #radius: [10, ]
        #pos_hint: {"center_x": .5, "center_y": .5}
        #md_bg_color: app.theme_cls.disabled_hint_text_color

        MDToolbar:
            title: 'Menu'
            md_bg_color: 1, 0, 1, 1
            left_action_items: [["menu", lambda x: x]]

        Label:
            text: "[color=FF00FF]ГЛАВНОЕ ОКНО[/color]"
            markup: True
            #font_size: "H6"
            pos_hint: {"center_x": .5}
            #adaptive_size: True

        GridLayout:
            cols: 3
            Button:
                text: 'открыть окно для добавления'
                #on_release: root.search_name_birth('alesya', '2002-22-10')
                #on_press: root.choose_date()
                #on_press: root.delete_vet_name_last_appointment_date('alesya', '2022-03-17')
                on_release: Factory.AddPopup(root.r_c(), root.r_m()).open()
                #on_release: root.clear()
                #on_release: root.show_dialog()
            Button:
                text: 'открыть окно для поиска'
                #on_release: root.search_name_birth('alesya', '2002-22-10')
                #on_press: root.choose_date()
                #on_press: root.delete_vet_name_last_appointment_date('alesya', '2022-03-17')
                on_release: Factory.SearchPopup(root.r_c(), root.r_m()).open()
            Button:
                text: 'открыть окно для удаления'
                #on_release: root.search_name_birth('alesya', '2002-22-10')
                #on_press: root.choose_date()
                #on_press: root.delete_vet_name_last_appointment_date('alesya', '2022-03-17')
                on_release: Factory.DeletePopup(root.r_c(), root.r_m()).open()